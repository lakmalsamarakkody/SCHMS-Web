{{ template.header|raw }}

<body>

    <div class="container-fluid home">
        <div class="row">
            
            {{ template.sidenav|raw }}

            <div class="col-md-10 content">

                {{ template.topmenu|raw }}

                <div class="container">
                    <div class="row">

                        <div class="col-md-8 mt-4 mx-auto">
                            <div class="card">
                                <div class="card-header" style="background-color: #8f75da; color: #FFFFFF;">ADD NEW USER</div>
                                <div class="card-body">

                                    <form>
                                        <div class="row">
                                            <div class="col">
                                                <div class="form-group">
                                                    <label>User Role</label>
                                                    <select class="form-control" id="role_id" required>
                                                        {% for role in user.roles %}
                                                        <option value="{{ role.id }}">{{ role.name }}</option>
                                                        {% endfor %}
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="col">
                                                <div class="form-group">
                                                    <label>Username</label>
                                                    <input type="text" id="username" class="form-control" />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col">
                                                <div class="form-group">
                                                    <label>Password</label>
                                                    <input type="password" id="pass" class="form-control" />
                                                </div>
                                            </div>
                                            <div class="col">
                                                <div class="form-group">
                                                    <label>Confirm Password</label>
                                                    <input type="password" id="pass_confirm" class="form-control" />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col">
                                                <div class="form-group">
                                                    <label>Email</label>
                                                    <input type="text" id="email" class="form-control" />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="button-group mx-auto">
                                                <button type="button" id="btn-submit" class="btn btn-danger">CREATE</button>
                                                <button type="reset" id="btn-clear" class="btn btn-secondary">CLEAR</button>
                                            </div>
                                        </div>
                                    </form>

                                </div>
                            </div>
                        </div>

                    </div>
                </div>

            </div>

        </div>
    </div>

    {{ template.footer|raw }}

    <script>
        $("#btn-submit").click(function(event) {
            event.preventDefault();

            // PAYLOAD
            var formData = new FormData;
            formData.append('role_id', $("#role_id").val());
            formData.append('username', $("#username").val());
            formData.append('pass', $("#pass").val());
            formData.append('pass_confirm', $("#pass_confirm").val());
            formData.append('email', $("#email").val());

            // REQUEST
            $.ajax({
                url: "{{ app.url }}/user/ajax_add",
                method: 'POST',
                data: formData,
                processData: false,
                contentType: false,
                dataType: 'json',
                success: (res) => {
                    if ( res.status == 'success' ) {
                        alertify.alert("Success", "User added successfully ... ").set('onok', function() {
                            location.reload();
                        })
                    } else {
                        console.log(res);
                        alertify.alert(res.error);
                    }
                },
                error: (e) => {
                    alertify.alert("Error", "Something went wrong ... ");
                    console.log(e.responseText)
                }
            })

        })

    </script>

</body>
</html>